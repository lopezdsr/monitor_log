---

copyright:
  years: 2015, 2017

lastupdated: "2017-04-06"

---


{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:screen: .screen}

# Grafana ダッシュボードの作成
{:#monitoring_grafana}

カスタム Grafana ダッシュボードを作成して、{{site.data.keyword.Bluemix}} 組織のスペース内で実行されるすべてのコンテナーのメトリックを表示します。
{:shortdesc}

以下のステップを実行して Grafana ダッシュボードを作成します。

1. Web ブラウザーから Grafana を起動します。詳しくは、『[Web ブラウザーから Grafana ダッシュボードへのナビゲート](monitoring_analyzing_metrics_grafana.html#launch_grafana_from_browser)』を参照してください。

2. デフォルト・ダッシュボードを保存します。

    1. ツールバーで、「保存」アイコンをクリックします。
    2. ダッシュボードの名前を入力します。
    3. 名前フィールドの横の「保存」アイコンをクリックします。
   
3. ダッシュボードでの作業中は、自動ページ更新を無効にします。 

    1. ヘッダーにあるタイム・ピッカーをクリックします。
    2. **「Auto-refresh」**を選択します。
    3. **「Off」**をクリックします。
 
 5. サンプル行を削除します。
 
     1. *「Welcome to Grafana」*ヘッダーの横にある行メニュー・スライダーにカーソルを移動して、スライド・アウトする行メニュー・アイコンをクリックします。
     2. **「Delete row」**をクリックし、**「Yes」**をクリックします。
     
     上記のステップを繰り返して、資料リンクと最初のグラフの行を削除します。 
     
     ページ・ヘッダーで、データを参照できるようにタイム・ピッカーを調整します。デフォルト値は数秒前までの 6 時間です。**「Last 30d」**を選択します。
     
6. 視覚化を追加します。

    * CPU アイドルの視覚化を追加するには、[CPU アイドル視覚化の追加](monitoring_grafana.html#grafana_add_cpu)を参照してください。
    * 使用メモリーの視覚化を追加するには、[使用メモリー視覚化の追加](monitoring_grafana.html#grafana_add_mem)を参照してください。
        
7. カスタム・ダッシュボードを保存します。

    1. ツールバーで、「保存」アイコンをクリックします。
    2. ダッシュボードの名前を入力します。
    3. 名前フィールドの横の「保存」アイコンをクリックします。
    

## CPU アイドル視覚化の追加
{:#grafana_add_cpu}

スペース内の全コンテナーからのデータが組み込まれた CPU アイドル・グラフを追加するには、以下のステップを実行します。

1. **「Add a row」**ボタンをクリックします。行メニュー・スライダーが行の横に表示されます。
    
2. 行メニュー・スライダーにカーソルを移動して、スライド・アウトする行メニュー・アイコンをクリックします。

3. **「Add Panel」**をクリックします。**「graph」**をクリックします。

4. グラフのタイトルをクリックして、パネル・メニューを開き、**「Edit」**をクリックします。 

    ダッシュボードの他の部分は非表示になります。このグラフのエディターとグラフのプレビューだけが表示されます。
    
5. 「Metrics」タブで、グラフのデータを収集するクエリーを作成します。 

    例えば、コンテナーを処理する場合、クエリー・フォーマットには、スペース ID、コンテナー・グループ ID、単一コンテナー・インスタンス ID が `space_ID.group_ID.instance_ID.metric` のフォーマットで含まれます。
        
    1. 行で**「Select metric」**をクリックします。その後、スペース ID を選択します。
    2. **「Select metric」**をクリックし、アスタリスク (\*) を選択します。
    
    (\*) を選択すると、スペース内のすべてのコンテナー・グループからのメトリックがデータに含まれます。オプションで、正規表現を使用してこのフォーマットを操作し、特定のコンテナーからのメトリックだけが含まれるようにすることもできます。例えば、単一コンテナーからのメトリックだけを表示してコンテナー・グループからのものは除外する場合、 **「Select metric」**をクリックし、**「0000」**を選択します。
        
    3. **「Select metric」**をクリックし、アスタリスク (\*) を再度選択します。このフォーマットにより、スペース内のすべての単一コンテナーからのメトリックが含められます。
        
    4. **「Select metric」**と**「cpu-0」**をクリックします。
        
    5. **「Select metric」**と**「cpu-idle」**をクリックします。グラフ・プレビューが更新されて、このクエリーに一致するメトリックが表示されます。
    
6. オプション: グラフの表示をカスタマイズします。
    
    * グラフに名前を指定するために、「General」タブをクリックし、「Title」フィールドにグラフの名前 (例えば、「CPU Idle」など) を入力します。
    * 垂直軸にラベルを付けるために、「Axes and grid」タブをクリックし、「Left Y Axis」セクションの「Label」フィールドに「CPU」と入力します。
    * グラフの背景色を変更するために、「Grid threshholds」セクションの「Level 2」で、背景色ピッカー・アイコンをクリックして背景色を白または明るいグレーに変更します。
    
    ヘッダーで、**「Back to dashboard」**をクリックします。
    
7. このダッシュボードに対して行った変更を保存するには、ヘッダーの「Save」アイコンをクリックしてから、メニューの「Save」アイコンをクリックします。


## 使用メモリー視覚化の追加
{:#grafana_add_mem}

使用メモリー視覚化を追加するには、以下のステップを実行します。

1. 「Add a row」ボタンをクリックします。行メニュー・スライダーが行の横に表示されます。
   
2. 行メニュー・スライダーにカーソルを移動して、スライド・アウトする行メニュー・アイコンをクリックします。

    1. 「Add Panel」>「graph」とクリックします。
    2. 「Edit」をクリックします。ダッシュボードの他の部分は非表示になります。このグラフのエディターとグラフのプレビューだけが表示されます。
    
3. 「Metrics」タブで、グラフのデータを収集するクエリーを作成します。 

    例えば、コンテナーを処理する場合、クエリー・フォーマットには、スペース ID、コンテナー・グループ ID、単一コンテナー・インスタンス ID が space_ID.group_ID.instance_ID.metric のフォーマットで含まれます。
        
    1. 行で**「Select metric」**をクリックします。その後、スペース ID を選択します。
    2. **「Select metric」**をクリックし、アスタリスク (\*) を選択します。
    
    (\*) を選択すると、スペース内のすべてのコンテナー・グループからのメトリックがデータに含まれます。オプションで、正規表現を使用してこのフォーマットを操作し、特定のコンテナーからのメトリックだけが含まれるようにすることもできます。例えば、単一コンテナーからのメトリックだけを表示してコンテナー・グループからのものは除外する場合、 **「Select metric」**をクリックし、**「0000」**を選択します。
    
    3. **「Select metric」**をクリックし、アスタリスク (\*) を再度選択します。このフォーマットにより、スペース内のすべての単一コンテナーからのメトリックが含められます。
        
    4. **「Select metric」**と**「memory」**をクリックします。
        
    5. **「Select metric」**と**「memory-used」**をクリックします。グラフ・プレビューが更新されて、このクエリーに一致するメトリックが表示されます。
    
6. オプション: グラフの表示をカスタマイズします。
    
    * グラフに名前を指定するために、「General」タブをクリックし、「Title」フィールドにグラフの名前 (例えば、「Memory Used」など) を入力します。
    *  垂直軸値のフォーマットを変更するために、「Axes and grid」タブをクリックし、「Left Y Axis」セクションの「Format」で「bytes」を選択します。
    * 垂直軸にラベルを付けるために、「Label」フィールドに「Memory」と入力します。
    * グラフの背景色を変更するために、「Grid threshholds」セクションの「Level 2」で、背景色ピッカー・アイコンをクリックして背景色を白または明るいグレーに変更します。
    
    ヘッダーで、**「Back to dashboard」**をクリックします。

7. このダッシュボードに対して行った変更を保存するには、ヘッダーの「Save」アイコンをクリックしてから、メニューの「Save」アイコンをクリックします。

